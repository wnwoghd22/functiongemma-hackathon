# 향후 벤치마크 점수 개선을 위한 2가지 전략적 선택지 (Strategic Options)

현재 순수 Prompt Engineering + Multi-Signal 기반의 `strategies/strategy_prompt_multisignal.py` 로직은 오버피팅 없이 **59.7%** 라는 매우 훌륭하고 안정적인 베이스라인을 달성했습니다. 로컬 모델의 빈 응답(Empty Call)을 대폭 줄여 On-device 비율을 23~27%까지 방어했습니다.

하지만 히든 테스트를 통과하면서도 60% 중후반 이상의 점수를 노리기 위해선 Local F1의 미세한 오류(예: 파라미터 값의 오타, 불필요한 공백 포함 등)를 극복해야 합니다. 여기서 우리는 두 가지 길 중 하나를 선택해야 합니다.

---

## 길 1: 일반적이고 방어적인 텍스트 정규화 도입 (Defensive Text Normalization)

특정 태스크(예: `set_alarm`이나 `send_message`) 이름에 하드코딩된 규칙을 넣는 오버피팅을 피하면서, **모든 도구에 공통으로 통용될 만한 "방어적 텍스트 청소(Cleaning) 우회로"**를 `main.py`에 아주 가볍게 추가하는 방향입니다.

### 적용 방안
1. **양끝 공백/구두점 제거**: 로컬 모델이 값으로 `" San Francisco "` 처럼 앞뒤 공백을 포함하거나 `"Alice."` 처럼 마침표를 덜컥 넣었을 때, 모든 String 파라미터를 순회하며 `.strip(" .,!?")` 처리를 일괄 적용합니다.
2. **숫자 추출 강제 방어**: Integer 타입 인자로 문자열이 넘어왔을 때(예: `"10"`), 오류로 간주해 무조건 클라우드로 보내지 말고 `int(value)`나 숫자 추출 정규식 `re.search(r'\d+', value)`를 한 번 거쳐서 살려냅니다.
3. **대소문자 보정(Title Case)**: `name`, `recipient`, `query` 등 고유명사가 들어갈 확률이 높은 범용 파라미터인 경우 `.title()` 처리를 시도합니다.

### 장단점
- **장점**: 철저히 범용적인(General-purpose) 정제이므로 히든 데이터셋에서도 작동할 확률이 매우 높습니다. 성공하면 로컬 콜의 F1이 크게 오르며(On-device 확보율 상승), 65~70점대 고득점을 노릴 수 있습니다.
- **단점**: 채점기가 의도적으로 대소문자를 판별하는 함정을 팠다면 깎일 위험이 있습니다.

---

## 길 2: 현재 베이스라인 확정 및 클라우드(Gemini) 속도/비용 최적화 (Baseline Freeze & Cloud Optimization)

로컬의 결과물을 교정하려고 애쓰면 쓸수록 코드만 복잡해지고 사이드 이펙트(Side-effect)가 커질 위험이 존재합니다. 따라서 "구조나 값이 이상하면 무조건 Cloud로 보낸다"는 현재의 59.7% 베이스라인을 그대로 제출본으로 확정하는 방향입니다.

### 적용 방안
1. `_should_fallback` 게이트는 절대 손대지 않습니다.
2. **Gemini 연결 개선**: 대신 클라우드에서 잡아먹는 **Time Score**를 최소화하기 위해 API 호출부(`_generate_cloud`)의 파라미터를 극한으로 깎습니다. (예: `temperature=0.0`, 불필요한 토큰 반환 제한 등).
3. 현재의 `strategy_prompt_multisignal.py` 로직을 그대로 `main.py`에 적용해 제출본을 만듭니다.

### 장단점
- **장점**: 오버피팅의 위험도가 **0%**에 가깝습니다. 히든 데이터셋에서도 현재 점수(59~60점)를 확정적으로 방어할 수 있는, 가장 정석적이고 안전한 해커톤용 제출본입니다.
- **단점**: Cloud Fallback이 여전히 70%대를 유지하기 때문에 Time/On-device 점수 확보 공식(25%+25%)상 드라마틱한 상위권 점수 달성은 수학적으로 불가능합니다.

---

### 진행 방향 제안
아슬아슬한 고득점을 원하신다면 **길 1(일반적 텍스트 보정)**을 적용한 뒤 한 번 더 벤치마크를 돌려보는 것을 권장드립니다! 만약 안정적인 수상을 원하신다면 **길 2(현재 버전 확정)**로 제출을 끝낼 수 있습니다.
